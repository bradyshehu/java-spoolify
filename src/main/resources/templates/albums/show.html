<!DOCTYPE html>
<html lang="en">
  <head>
    <th:block th:replace=" home :: head"></th:block>
  </head>
  <body>
    <header th:insert="home :: navbar" />
    <main>
      <section class="container">
        <div class="row">
          <div class="col-12">
            <div class="card" th:object="${album}">
              <div class="row g-0">
                <div class="col-6">
                  <img th:src="*{img}" th:alt="*{name}" />
                </div>
                <div class="card-head col-6 p-3">
                  <h4 th:text="*{name}"></h4>
                  <section class="py-3">
                    <p>
                      <strong>Descrizione:</strong> <br />
                      <span th:text="*{description}"></span>
                    </p>
                    <p>
                      <strong>Artista principale:</strong>
                      <span th:text="*{mainArtist}"></span>
                    </p>
                    <p>
                      <strong>Data di uscita:</strong>
                      <span th:text="*{releaseDate}"></span>
                    </p>
                    <p th:if="*{songs.size() > 0}">
                      <strong>Tracce totali:</strong>
                      <span th:text="*{totalTracks}"></span>
                    </p>
                    <p th:if="*{songs.size() > 0}">
                      <strong>Minutaggio totale:</strong>
                      <span th:text="*{totalDuration}"></span>
                      <span>Minuti</span>
                    </p>
                    <h5>Generi:</h5>
                    <ul th:if="*{albumGenres.size() > 0}">
                      <li th:each="genre : *{albumGenres}">
                        <span th:text="${genre.name}"></span>
                      </li>
                    </ul>
                    <p th:unless="*{albumGenres.size() > 0}">
                      Non ci sono generi per questo album.
                    </p>
                  </section>
                </div>
                <div class="card-body col-12">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <h3>Tracce di questo album</h3>
                    <div>
                      <a
                        sec:authorize="hasAuthority('ADMIN')"
                        class="btn btn-sm btn-primary"
                        th:href="@{/albums/{id}/songs(id=*{id})}"
                        >Aggiungi una traccia</a
                      >
                    </div>
                  </div>
                  <table
                    th:if="*{songs.size() > 0}"
                    class="table table-striped table-hover align-middle"
                  >
                    <thead>
                      <tr>
                        <th>Numero</th>
                        <th>Nome</th>
                        <th>Durata</th>
                        <th>Esplicito</th>
                        <th></th>
                        <th></th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr
                        th:each="song, iterStat : *{songs}"
                        th:object="${song}"
                      >
                        <td th:text="${iterStat.count}"></td>
                        <td th:text="*{name}"></td>
                        <td th:text="*{duration}"></td>
                        <td>
                          <span th:if="*{isExplicit}">SÃ­</span>
                          <span th:unless="*{isExplicit}">No</span>
                        </td>
                        <td>
                          <a
                            class="btn btn-sm btn-primary"
                            th:href="@{/songs/{id}(id=*{id})}"
                            >Dettagli</a
                          >
                        </td>
                        <td>
                          <a
                            sec:authorize="hasAuthority('ADMIN')"
                            class="btn btn-sm btn-success"
                            th:href="@{/songs/edit/{id}(id=*{id})}"
                            >Modifica</a
                          >
                        </td>
                        <td>
                          <form
                            sec:authorize="hasAuthority('ADMIN')"
                            method="POST"
                            th:action="@{/songs/delete/{id}(id=*{id})}"
                          >
                            <button
                              onclick="return confirm('Sei sicuro di voler eliminare questa canzone?')"
                              class="btn btn-sm btn-danger"
                            >
                              Elimina
                            </button>
                          </form>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <div class="my-3" th:unless="*{songs.size() > 0}">
                    <p class="alert alert-warning">
                      Non ci sono canzoni disponibili per questo album al
                      momento.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-between my-3">
          <a class="btn btn-secondary" th:href="@{/albums}"
            >Torna a tutti gli album</a
          >
          <a
            class="btn btn-primary"
            th:href="@{/albums/edit/{id}(id=${album.id})}"
            >Modifica [[${album.name}]]</a
          >
        </div>
      </section>
    </main>
    <div th:replace="home :: bs-script"></div>
  </body>
</html>
